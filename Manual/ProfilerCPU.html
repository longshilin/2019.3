<!DOCTYPE html><html class="no-js" lang="zh_CN">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<meta property="og:title" content="CPU Usage Profiler module - Unity Manual">
<title>CPU Usage Profiler module - Unity Manual</title>
<meta property="og:image" content="https://docs.unity3d.com/zh_CN/2019.3/uploads/Main/cpu-profiler-window.png">
<meta name="description" content="The CPU Usage Profiler module contains a chart that displays where time is spent in your application. It provides an overview of all the significant areas where your application spends time, such as on rendering, its scripts, and animation. This section of the documentation covers:">
<meta property="og:description" content="The CPU Usage Profiler module contains a chart that displays where time is spent in your application. It provides an overview of all the significant areas where your application spends time, such as on rendering, its scripts, and animation. This section of the documentation covers:">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFiles/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script>
      var docs_type = 'Manual';
      var lang = 'zh_CN';
      var page = 'ProfilerCPU';
      if(!page) page = 'index';
      var version = '2019.3';
      var docs_versions = [{version: '2019.3',version_string: '2019.3'},{version: '2019.2',version_string: '2019.2'},{version: '2019.1',version_string: '2019.1'},{version: '2018.4',version_string: '2018.4'},{version: '2018.3',version_string: '2018.3'},{version: '2018.2',version_string: '2018.2'},{version: '2018.1',version_string: '2018.1'},{version: '2017.4',version_string: '2017.4'},{version: '2017.3',version_string: '2017.3'},{version: '2017.2',version_string: '2017.2'},{version: '2017.1',version_string: '2017.1'},{version: '5.6',version_string: '560'},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
<link rel="canonical" href="https://docs.unity3d.com/zh_CN/2019.3/Manual/ProfilerCPU.html">
<link rel="alternate" href="https://docs.unity3d.com/en/2019.3/Manual/ProfilerCPU.html" hreflang="en">
<link rel="alternate" href="https://docs.unity3d.com/ja/2019.3/Manual/ProfilerCPU.html" hreflang="ja">
<link rel="alternate" href="https://docs.unity3d.com/es/2019.3/Manual/ProfilerCPU.html" hreflang="es">
<link rel="alternate" href="https://docs.unity3d.com/kr/2019.3/Manual/ProfilerCPU.html" hreflang="ko">
<link rel="alternate" href="https://docs.unity3d.com/2019.3/Documentation/Manual/ProfilerCPU.html" hreflang="x-default">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.3</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/ProfilerCPU.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/ProfilerCPU.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/ProfilerCPU.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/ProfilerCPU.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/ProfilerCPU.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/ProfilerCPU.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/ProfilerCPU.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/ProfilerCPU.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/ProfilerCPU.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/ProfilerCPU.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/ProfilerCPU.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/ProfilerCPU.html">5.6</a></li>
</ul></div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2019.3/Documentation/Manual/ProfilerCPU.html">English</a></li>
<li><a data-lang="ja" href="/ja/2019.3/Manual/ProfilerCPU.html">日本語</a></li>
<li><a data-lang="es" href="/es/2019.3/Manual/ProfilerCPU.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2019.3/Manual/ProfilerCPU.html">한국어</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>Manual</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.3</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/ProfilerCPU.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/ProfilerCPU.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/ProfilerCPU.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/ProfilerCPU.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/ProfilerCPU.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/ProfilerCPU.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/ProfilerCPU.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/ProfilerCPU.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/ProfilerCPU.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/ProfilerCPU.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/ProfilerCPU.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/ProfilerCPU.html">5.6</a></li>
</ul></div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2019.3)</a></li>
<li><a href="UnityOverview.html">在 Unity 中操作</a></li>
<li><a href="analysis.html">Analysis</a></li>
<li><a href="Profiler.html">Profiler overview</a></li>
<li>CPU Usage Profiler module</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="ProfilerAudio.html"></a></span><div class="tip">音频性能分析器 (Audio Profiler)</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ProfilerGI.html"></a></span><div class="tip">Global Illumination Profiler module</div>
</div>
</div></div>
<h1>CPU Usage Profiler module</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>The CPU Usage Profiler module contains a chart that displays where time is spent in your application. It provides an overview of all the significant areas where your application spends time, such as on rendering, its scripts, and animation. This section of the documentation covers:</p>

<ul>
<li><a href="#charts">Chart categories</a></li>
<li>
<a href="#details-pane">Module details pane</a>

<ul>
<li><a href="#timeline">Timeline view</a></li>
<li>
<a href="#hierarchy">Hierarchy and Raw Hierarchy view</a>

<ul>
<li><a href="#samples">Common samples</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#warnings">Performance warnings</a></li>
<li><a href="#allocation-callstacks">Allocation call stacks</a></li>
<li><a href="#editor-only">Editor-only samples</a></li>
</ul>

<p><a name="charts"></a></p>

<h2>Chart categories</h2>

<p>The CPU Usage Profiler module’s chart tracks the time spent on the application’s main thread. The timings are divided into nine categories. To change the order of the categories in the chart, you can drag and drop them in the chart’s legend. You can also click a category’s colored legend to toggle its display.</p>

<figure>
<img src="../uploads/Main/cpu-profiler-window.png" alt="The CPU Usage Profiler module">
<figcaption>The CPU Usage Profiler module</figcaption>
</figure>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"><strong>Category</strong></th>
	<th style="text-align:left;"><strong>描述</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><strong>Rendering</strong></td>
	<td style="text-align:left;">How much time your application spends on rendering graphics.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Scripts</strong></td>
	<td style="text-align:left;">How much time your application spends on running scripts.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Physics</strong></td>
	<td style="text-align:left;">How much time your application spends on the physics engine.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>动画</strong></td>
	<td style="text-align:left;">How much time your application spends on animating Skinned Mesh Renderers, GameObjects and other components in your application. This also includes the time spent on calculations for systems the Animation and Animator components use.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>GarbageCollector</strong></td>
	<td style="text-align:left;">How much time your application spends on running the <a href="../ScriptReference/Scripting.GarbageCollector.html">Garbage Collector</a>.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>VSync</strong></td>
	<td style="text-align:left;">How much time your application spends per frame waiting for the <a href="../ScriptReference/Application-targetFrameRate.html">targetFrameRate</a> or the next VBlank to sync with. This is according to the <a href="../ScriptReference/QualitySettings-vSyncCount.html">QualitySettings.vSyncCount</a> value, the target framerate, or the VSync setting that is the default or enforced maximum of the platform your application is running on. For more information about VSync, see the section in this documentation on <a href="#samples">Rendering and VSync samples</a>.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Global Illumination</strong></td>
	<td style="text-align:left;">How much time your application spends on lighting.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>UI</strong></td>
	<td style="text-align:left;">How much time your application spends on displaying your its UI.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Others</strong></td>
	<td style="text-align:left;">How much time your application spends on code that does not fall into any of the other categories. This includes areas like the entire <a href="#editorloop">EditorLoop</a>, or the Profiling overhead when profiling Play Mode in the Editor.</td>
</tr>
</tbody>
</table>

<p><a name="details-pane"></a></p>

<h2>Module details pane</h2>

<p>When you select the CPU Usage module, the details pane below it displays a breakdown of where the application spent time in the selected frame. You can display the timing data as either a timeline or a hierarchical table; to change the display, use the top-left dropdown in the details pane (set to <strong>Timeline</strong> by default). The three views available are:</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"><strong>View</strong></th>
	<th style="text-align:left;"><strong>功能</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><strong>Timeline</strong></td>
	<td style="text-align:left;">Displays a breakdown of the timings for a particular frame, alongside a time axis of the frame’s length. This is the only view mode that you can use to see timings on threads other than the main thread, and correlate timings across threads (for example, <a href="JobSystem.html">Job System</a> worker threads starting up after a system on the main thread schedules them).</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Hierarchy</strong></td>
	<td style="text-align:left;">GGroups the timing data by its internal hierarchical structure. This option displays the elements that your application called in a descending list format, ordered by the time spent by default. You can also order the information by the amount of scripting memory allocated (<strong>GC Alloc</strong>), or the number of calls. To change the column that orders the table, click the table column’s header.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Raw Hierarchy</strong></td>
	<td style="text-align:left;">Displays the timing data in a hierarchical structure that is similar to the call stacks where the timing occurred. Unity lists each call stack separately in this mode instead of merging them, as it does in <strong>Hierarchy</strong> view.</td>
</tr>
</tbody>
</table>

<p><a name="timeline"></a></p>

<h2>Timeline view</h2>

<figure>
<img src="../uploads/Main/profiler-cpu-timeline-view.png" alt="CPU Usage Profiler module with the Timeline view">
<figcaption>CPU Usage Profiler module with the Timeline view</figcaption>
</figure>

<p>The <strong>Timeline</strong> view is the default view for the CPU Usage Profiler module. It contains an overview of where time is spent in your application and how the timings relate to each other. The Timeline view displays profiling data from all threads in their own own subsections and along the same time axis. This is unlike the Hierarchy views, which only show profiling data from the main thread. </p>

<p>You can use the Timeline view to see how activities on the different threads correlate to each other in their parallel execution. You can see how much or little you are using the different threads, such as the <a href="JobSystem.html">Job System</a>’s worker threads, how work on the threads are queued up, and if any thread is idling (<strong>Idle</strong> sample) or waiting for another thread or a Job to finish (<strong>Wait for x</strong> sample).</p>

<h3>Navigating and selecting items</h3>

<p>To zoom in on areas of the time axis, use the scroll wheel on your mouse, or press and hold the Alt key while you drag with the right mouse button pressed down. You can also use the ends of the horizontal scrollbar to zoom in. Press the A key on your keyboard to reset the zoom so that the entire frame time is visible. </p>

<p>Whenever you see a white arrow on the bottom of a thread, you can click it to unfold the thread to show all lines, or click again to show only the top ones. You can also drag the line that separates the threads to readjust how many lines you can see. Double-clicking the line sets the height of the thread’s section to the maximum depth of the call stack. To pan the view, press the middle mouse button, or hold the Alt key (Command key on macOS) and press the left mouse button. </p>

<p>To collapse and expand groups of threads, click on the foldout arrows next to the thread names on the far left of the view. </p>

<p>To see an item’s contribution to the CPU chart, select it in the lower pane. The Profiler highlights its contribution, and dims the rest of the chart. To deselect the item, click elsewhere in the view. Press the F key to focus the current sample you selected, or to show the default zoom level if you’ve selected nothing.</p>

<figure>
<img src="../uploads/Main/profiler-cpu-selected-module.png" alt="CPU Usage module in Timeline view, with a selected item">
<figcaption>CPU Usage module in Timeline view, with a selected item</figcaption>
</figure>

<p>In the image above, the tooltip on the selected item provides further details, such as the number of instances and the total time of this sample across all threads. <strong>GC.Alloc</strong> samples appear colored in red-magenta, and show you the size of the allocation. </p>

<p>To show managed call stacks in the tooltip, navigate to the Profiler window’s toolbar, and select the <strong>Call Stacks</strong> button. You must enable this property before you profile a frame to display the call stack for a frame. For more information, see the section on <a href="#callstacks">Allocation call stacks</a>.</p>

<p>You can also manually measure any time span in the Timeline view; to do this, click and drag horizontally anywhere to display an overlay across a section of the timeline. The time ruler at the top displays the time encompassed by that overlay. Press the F key while the overlay is displayed to frame the view horizontally along the selected time section. Click anywhere to remove the overlay.</p>

<p><a name="hierarchy"></a></p>

<h2>Hierarchy and Raw Hierarchy view</h2>

<p>When you switch to the <strong>Hierarchy</strong> or <strong>Raw Hierarchy</strong> view, your selection carries over, as long as the sample is on the main thread. If you cannot immediately find your selection, press the F key to focus it. </p>

<figure>
<img src="../uploads/Main/profiler-cpu-hierarchy-view.png" alt="The CPU Usage Profiler module with the Hierarchy view">
<figcaption>The CPU Usage Profiler module with the Hierarchy view</figcaption>
</figure>

<p>The <strong>Hierarchy</strong> view lists all samples you have profiled and groups them together by their shared call stack and the hierarchy of ProfilerMarkers. The <strong>Raw Hierarchy</strong> view does not group samples together, which makes it ideal for looking into samples on a granular level. You can also use the <strong>Thread</strong> dropdown to select a specific thread, like the Main Thread or Render Thread to inspect in these views. Both views display the following detailed information for each item in the Hierarchy, next to each row:</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"><strong>属性</strong></th>
	<th style="text-align:left;"><strong>功能</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><strong>Total</strong></td>
	<td style="text-align:left;">The total amount of time Unity spent on a particular function, as a percentage.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Self</strong></td>
	<td style="text-align:left;">The total amount of time Unity spent on a particular function as a percentage, excluding the time Unity spends calling sub-functions. <br> <br> For example, in the screenshot, 41.7% of time is spent in the <code>Camera.Render</code> function. This is because it calls a lot of drawing and culling functions. However, when you exclude the functions it calls, only 3.5% of time is spent on the <code>Camera.Render</code> function itself.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Calls</strong></td>
	<td style="text-align:left;">The number of calls made to this function in this frame. In the <strong>Raw Hierarchy</strong> view the values in this column are always 1 because the Profiler does not merge the hierarchy of samples.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>GC Alloc</strong></td>
	<td style="text-align:left;">How much scripting heap memory Unity has allocated in the current frame. The scripting heap memory is managed by the <a href="BestPracticeUnderstandingPerformanceInUnity4-1.html">garbage collector</a>. <br> <br> Whenever Unity calls <code>GC.Collect()</code> or there is a scripting heap allocation that does not fit within the heap’s current size, the garbage collector triggers. It marks all allocations that have no more references to them and collects them. This process appears as <strong>GC.Collect</strong> samples in the Profiler. <br> <br> Unity runs the garbage collector more frequently as you allocate more on the heap. As the managed heap grows, it takes Unity longer to mark and collect the memory. As such, you should keep the <strong>GC Alloc</strong> value at zero while your application runs, to prevent the garbage collector from affecting your framerate, and keep the overall heap size small.<br> <br> For more details about the managed heap see the documentation on <a href="UnderstandingAutomaticMemoryManagement.html">Understanding Automatic Memory Management</a>.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Time ms</strong></td>
	<td style="text-align:left;">The total amount of time Unity spent on a particular function, in milliseconds. If your application uses the <a href="JobSystem.html">Job System</a> or multithreaded rendering, this information might be misleading, because it only contains the time Unity spent on the currently selected thread. To change the thread, select the <strong>Thread</strong> dropdown at the top of the Hierarchy pane.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Self ms</strong></td>
	<td style="text-align:left;">The total amount of time Unity spent on a particular function, in milliseconds, excluding the time Unity spends calling sub-functions.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Warning</strong></td>
	<td style="text-align:left;">Indicated by a warning icon, this displays how many times the application has triggered a warning during the current frame. For more information, see the <a href="#warnings">Performance warnings</a> section of this documentation.</td>
</tr>
</tbody>
</table>

<p>To get more information about where your application calls and uses the profiled functions, select the <strong>Details</strong> dropdown at the top right hand corner of the module details pane and choose either <strong>Show Related Objects</strong> or <strong>Show Calls</strong> view.</p>

<figure>
<img src="../uploads/Main/profiler-show-related-objects.png" alt="Show Related Objects panel">
<figcaption><strong>Show Related Objects</strong> panel</figcaption>
</figure>

<p>The <strong>Show Related Objects</strong> view displays a list of <strong>UnityEngine.Objects</strong> that are associated with the Profiler sample, using the <a href="../ScriptReference/Unity.Profiling.ProfilerMarker.Begin.html">Begin()</a> overload that takes a <strong>UnityEngine.Object</strong>. Some samples Unity reports have these associations built in, such as <strong>Camera.Render</strong> samples that are linked to the Camera object that does the rendering. Unity reports these objects via their instance ID and resolves them to a name in the Profiler window. </p>

<p>When you click on one of these objects, Unity tries to find the object via the Scene hierarchy and <a href="../ScriptReference/EditorGUIUtility.PingObject.html">ping</a> it. Because the association uses the instance ID, pinging only works when you are profiling your application in the Editor, and for as long as the object still exists. </p>

<p>For <strong>GC.Alloc</strong> samples, this view displays a list of “N/A” items, one for each allocation that occured at this hierarchy level, with the size of the allocation listed in the <strong>GC.Alloc</strong> column. If you profile your application in the Editor with the <strong>Call Stacks</strong> setting enabled, when you select a GC.Alloc sample in this view, the call stack for the allocated scripting object you selected is displayed, even if you did not enable the <strong>Deep Profiling</strong> setting. For more information, see the <a href="#allocation-callstacks">Allocation call stacks</a> section of this documentation.</p>

<figure>
<img src="../uploads/Main/profiler-show-calls.png" alt="Show Calls panel">
<figcaption>Show Calls panel</figcaption>
</figure>

<p>The <strong>Show Calls</strong> view displays where the selected sample is being called from as well as what other functions it calls to.</p>

<p>Additionally, under the gear icon at the top of the module details pane, you can enable or disable the <strong>Collapse Editor Only Samples</strong> setting. This collapses all samples in the Player Loop that only happen because of Editor-only safety checks. When the samples are collapsed, their GC.Alloc value does not contribute to GC.Alloc value of their enclosing sample. This setting is enabled by default. For more information, see the <a href="#editor-only">Editor only samples</a> section of this documentation.</p>

<p><a name="samples"></a></p>

<h3>Common samples</h3>

<p>As well as samples that your scripting code generates, Unity provides a large number of samples that give you some insight into what is taking up time in your application. The following tables explain what some of the more common samples do.</p>

<h4>Main thread base samples</h4>

<p>The main thread base samples provide a clear separation between the time spent on your application and time spent on the Editor and Profiler activities. The <a href="../ScriptReference/Profiling.Recorder.html">Recorder</a> can also use these samples to get the timing of a frame on the main thread.</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"><strong>Sample</strong></th>
	<th style="text-align:left;"><strong>功能</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><strong>PlayerLoop</strong></td>
	<td style="text-align:left;">The root to any samples that originate from your application’s main loop. When you enable the <strong>Profile Editor</strong> setting while the Player is running in the Editor in active playmode, this sample nests under the <strong>EditorLoop</strong>.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>EditorLoop</strong></td>
	<td style="text-align:left;">The root to any samples that originate from the Editor’s main loop. This is only present while you profile a player in the Editor. When you disable the <strong>Profile Editor</strong> setting, this sample shows how much time of the frame was spent rendering and running the Editor that contains the Player.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Profiler.CollectEditorStats</strong></td>
	<td style="text-align:left;">The root for any samples that relate to collecting stats for different active Profiler modules. Any sample under the child sample Profiler.CollectGlobalStats incurs an overhead on the Player. All other child samples only affect the Editor. To turn specific modules off, close their chart or call <a href="../ScriptReference/Profiling.Profiler.SetAreaEnabled.html">Profiler.SetAreaEnabled()</a>.</td>
</tr>
</tbody>
</table>

<h4>Script update samples</h4>

<p>Unless you are using the Job System, most of your scripting code is nested underneath the following samples:</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"><strong>Sample</strong></th>
	<th style="text-align:left;"><strong>功能</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><strong>Update.ScriptRunBehaviourUpdate</strong></td>
	<td style="text-align:left;">This sample includes calls to <code>MonoBehaviour.Update</code> and processing of coroutines.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>BehaviourUpdate</strong></td>
	<td style="text-align:left;">This sample processes all <code>Update()</code> methods.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>CoroutinesDelayedCalls</strong></td>
	<td style="text-align:left;">Contains coroutine samples after their first yield.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>PreLateUpdate.ScriptRunBehaviourLateUpdate</strong></td>
	<td style="text-align:left;">This sample processes all <code>LateUpdate()</code> methods.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>FixedBehaviourUpdate</strong></td>
	<td style="text-align:left;">This sample processes all <code>FixedUpdate()</code> methods.</td>
</tr>
</tbody>
</table>

<h4>Rendering and VSync samples</h4>

<p>These samples show where the CPU spends time processing data for the GPU, or where it might be waiting for the GPU to finish. If the GPU Profiler is not available, or it is adding too much overhead, the toolbar does not show this information. These samples can give you an idea of if your application is CPU-bound or GPU-bound.</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"><strong>Sample</strong></th>
	<th style="text-align:left;"><strong>功能</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><strong>WaitForTargetFPS</strong></td>
	<td style="text-align:left;">The time your application spends waiting for the targeted FPS that <a href="../ScriptReference/Application-targetFrameRate.html">Application.targetFrameRate</a> specifies.<br> <br> If this sample is a sub-sample of <strong>Gfx.WaitForPresent</strong>, it represents the amount of time your application spends waiting for the VSync configured in <a href="../ScriptReference/QualitySettings-vSyncCount.html">QualitySettings.vSyncCount</a>.<br> <br> <strong>Note:</strong> The Editor doesn’t VSync on the GPU and instead uses <strong>WaitForTargetFPS</strong> to simulate the delay for VSync. Some platforms, in particular Android and iOS, enforce VSync or have a default frame rate cap of 30 or 60.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Gfx.ProcessCommands</strong></td>
	<td style="text-align:left;">Contains all processing of the rendering commands on the render thread. Some of that time might be spent waiting for VSync or new commands from the main thread, which you can see from it’s child sample <strong>Gfx.WaitForPresent</strong>.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Gfx.WaitForCommands</strong></td>
	<td style="text-align:left;">Indicates that the render thread is ready for new commands and might indicate a bottle neck on the main thread.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Gfx.PresentFrame</strong></td>
	<td style="text-align:left;">Indicates the time your application spends waiting for the GPU to render and present the frame, which might include waiting for VSync.<br> <br> A <strong>WaitForTargetFPS</strong> sample on the main thread shows how much of that time is spent waiting for VSync.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Gfx.WaitForPresent</strong></td>
	<td style="text-align:left;">Indicates that the main thread is ready to start rendering the next frame, but the render thread has not finished waiting on the GPU to present the frame. This might indicate that your application is GPU-bound. To see what the render thread is simultaneously spending time on, check the Timeline view.<br> <br> If the render thread spends time in <strong>Camera.Render</strong>, your application is CPU-bound and might be spending too much time sending draw calls or textures to the GPU.<br> <br> If the render thread spends time in <strong>Gfx.PresentFrame</strong>, your game is GPU-bound or it might be waiting for VSync on the GPU. A <strong>WaitForTargetFPS</strong> sub-sample of <strong>GFX.WaitForPresent</strong> indicates the portion of the Present phase that your application spends waiting for VSync. The Present phase is the portion of time between Unity instructing the graphics API to swap the buffers, to the time that this operation is completed</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Gfx.WaitForRenderThread</strong></td>
	<td style="text-align:left;">Indicates that the main thread is waiting for the render thread to process all the commands currently in its command stream. This sample only occurs in multithreaded rendering.</td>
</tr>
</tbody>
</table>

<h4>Multi threading samples</h4>

<p>These samples do not consume CPU cycles but instead highlight information that relates to threading and the JobSystem. When you see these samples, use the <a href="#timeline">Timeline view</a> to check what’s happening on other threads at the same time. </p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"><strong>Sample</strong></th>
	<th style="text-align:left;"><strong>功能</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><strong>Idle</strong></td>
	<td style="text-align:left;">Any time that the JobSystem does not untilize a Worker Thread, it emits an <strong>Idle</strong> sample. Small gaps between <strong>Idle</strong> samples usually happen when the JobSystem wakes them up, for example to schedule new Jobs. Longer gaps indicate a native Job that has not been instrumented.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Semaphore.WaitForSignal</strong></td>
	<td style="text-align:left;">This thread is waiting for something to finish on another thread. To find the thread it is waiting for, check the <strong>Timeline</strong> view for any samples that ended shortly before this one.</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>WaitForJobGroupID</strong></td>
	<td style="text-align:left;">A Sync Fence on a JobHandle was triggered. This might lead to <a href="https://docs.unity3d.com/ScriptReference/Unity.Jobs.IJobParallelFor.html">work stealing</a>, which happens when a worker finishes its work and then looks at other workers’ jobs to complete. These show up as job samples executed under this sample. Jobs that were “stolen” are not necessarily the jobs that were being waited on.</td>
</tr>
</tbody>
</table>

<h4>Physics samples</h4>

<p>The following table outlines some of the high-level physics Profiler samples. <code>FixedUpdate()</code> calls all of these samples.</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;" colspan="2"><strong>Sample</strong></th>
	<th style="text-align:left;"><strong>功能</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;" colspan="2"><strong>Physics.Simulate</strong></td>
	<td style="text-align:left;">Updates the state of the current physics by instructing the physics engine to run its simulation.</td>
</tr>
<tr>
	<td style="text-align:left;" colspan="2"><strong>Physics.Processing</strong></td>
	<td style="text-align:left;">Processes all non-cloth physics jobs. Expand this sample to show the low-level detail of the work done internally in the physics engine.</td>
</tr>
<tr>
	<td style="text-align:left;" colspan="2"><strong>Physics.ProcessingCloth</strong></td>
	<td style="text-align:left;">Processes all cloth physics jobs. Expand this sample to show the low-level detail of the work done internally in the physics engine.</td>
</tr>
<tr>
	<td style="text-align:left;" colspan="2"><strong>Physics.FetchResults</strong></td>
	<td style="text-align:left;">Collects the results of the physics simulation from the physics engine.</td>
</tr>
<tr>
	<td style="text-align:left;" colspan="2"><strong>Physics.UpdateBodies</strong></td>
	<td style="text-align:left;">Updates all the physics bodies’ positions and rotations. This sample also contains messages that communicate when these updates are sent.</td>
</tr>
<tr>
	<td style="text-align:left;" colspan="2"><strong>Physics.ProcessReports</strong></td>
	<td style="text-align:left;">Runs once the physics <code>FixedUpdate</code> ends. Processes the various stages of responding to the results of the simulation. Contacts, joint breaks and triggers update and message in this sample. There are four distinct sub stages:</td>
</tr>
<tr>
	<td style="text-align:left;"></td>
	<td style="text-align:left;"><strong>Physics.TriggerEnterExits</strong></td>
	<td style="text-align:left;">Processes <code>OnTriggerEnter</code> and <code>OnTriggerExit</code> events.</td>
</tr>
<tr>
	<td style="text-align:left;"></td>
	<td style="text-align:left;"><strong>Physics.TriggerStays</strong></td>
	<td style="text-align:left;">Processes <code>OnTriggerStay</code> events.</td>
</tr>
<tr>
	<td style="text-align:left;"></td>
	<td style="text-align:left;"><strong>Physics.Contacts</strong></td>
	<td style="text-align:left;">Processes <code>OnCollisionEnter</code>, <code>OnCollisionExit</code>, and <code>OnCollisionStay</code> events.</td>
</tr>
<tr>
	<td style="text-align:left;"></td>
	<td style="text-align:left;"><strong>Physics.JointBreaks</strong></td>
	<td style="text-align:left;">Processes updates and messages relating to broken joints.</td>
</tr>
<tr>
	<td style="text-align:left;" colspan="2"><strong>Physics.UpdateCloth</strong></td>
	<td style="text-align:left;">Contains updates relating to cloth and their Skinned Meshes.</td>
</tr>
<tr>
	<td style="text-align:left;" colspan="2"><strong>Physics.Interpolation</strong></td>
	<td style="text-align:left;">Manages the interpolation of positions and rotations for all the physics objects.</td>
</tr>
</tbody>
</table>

<p>To learn more about script life cycles and general samples within a script life cycle, see <a href="https://docs.unity3d.com/Manual/ExecutionOrder.html#UpdateOrder">Order of Execution for Event Functions</a>.</p>

<p><a name="warnings"></a></p>

<h2>性能警告</h2>

<p>The CPU Profiler can detect some common performance issues and warn you about them. These appear in the <strong>Warning</strong> column of the Hierarchy view in the module details pane.</p>

<figure>
<img src="../uploads/Main/ProfilerCPUWarningCount.png" alt="性能分析器警告指示已移动静态碰撞体">
<figcaption>性能分析器警告指示已移动静态碰撞体</figcaption>
</figure>

<p>The Profiler can detect some specific calls that you should avoid in performance-critical contexts. It displays the warnings with the reasons the operations are expensive as follows: </p>

<ul>
<li>
<strong>Rigidbody.SetKinematic:</strong> recreate non-convex MeshCollider for Rigidbody</li>
<li>
<strong>Animation.DestroyAnimationClip:</strong> triggers RebuildInternalState</li>
<li>
<strong>Animation.AddClip:</strong> triggers RebuildInternalState</li>
<li>
<strong>Animation.RemoveClip:</strong> triggers RebuildInternalState</li>
<li>
<strong>Animation.Clone:</strong> triggers RebuildInternalState</li>
<li>
<strong>Animation.Deactivate:</strong> triggers RebuildInternalState</li>
</ul>

<p><a name="allocation-callstacks"></a></p>

<h2>Allocation call stacks</h2>

<p>By default, allocated call stacks on <strong>GC.Alloc</strong> samples are disabled, because they can disrupt your application with multi frame delay. However, you sometimes might want to see the full call stack to see how Unity executes your code. </p>

<p>To do this, navigate to the toolbar of the Profiler window, and select the <strong>Call Stacks</strong> button. You can use this functionality whether you profile in the Editor or on a running Player. In the frames you profile after you turn this option on, the <strong>GC.Alloc</strong> samples contain their callstacks. </p>

<p>Every scripting heap allocation shows up as a <strong>GC.Alloc</strong> sample in both the Hierarchy view and Timeline view. In Timeline view, it is colored bright magenta. To see a call stack, select the CPU Profiler Module and select a <strong>GC.Alloc</strong> sample in Timeline view. The call stack appears in the selection highlight. </p>

<figure>
<img src="../uploads/Main/profiler-cpu-allocation-callstacks.png" alt="CPU Usage module in Timeline view with a GC.Alloc call stack">
<figcaption>CPU Usage module in Timeline view with a GC.Alloc call stack</figcaption>
</figure>

<p>Alternatively you can see the call stack in Hierarchy or Raw Hierarchy view. Set the <strong>Details</strong> view to <strong>Show Related Objects</strong>. Because GC.Alloc samples have no name, they show up as N/A in this panel. When you select an N/A object, the Profiler displays the call stack in the bottom half of the details view.</p>

<p>For more information about managed allocations, see documentation on <a href="UnderstandingAutomaticMemoryManagement.html">Understanding Automatic Memory Management</a>.</p>

<figure>
<img src="../uploads/Main/profiler-cpu-heirarchy-callstack.png" alt="Callstack in the Hierarchy view">
<figcaption>Callstack in the Hierarchy view</figcaption>
</figure>

<p><a name="editor-only"></a></p>

<h2>Editor only samples</h2>

<p>Some samples are only present when you are profiling in the Editor. This includes security checks like the <strong>GetComponentNullErrorWrapper</strong>, which helps to identify a null component usage; <strong>CheckConsistency</strong>, which validates object setup; <strong>CheckAllowDestructionRecursive</strong>, which is a destruction check; and Prefab-related activities. All of these samples are not present in the Player.</p>

<p>By default, Editor-only samples are collapsed in the Hierarchy view, and are named <code>EditorOnly [SampleName]</code>. While they might cause garbage collection allocation, they do not contribute to the <strong>GC.Alloc</strong> value of their enclosing sample if they are collapsed.</p>

<p>To change the default behavior, click the context menu in the top right of the module details pane and disable the <strong>Collapse EditorOnly Samples</strong> setting. When you do this, you can expand the sample and contribute its GC.Alloc value to the enclosing sample.</p>

<p>This option does not affect the Timeline view. You can usually ignore these samples, or use them as a prompt to profile Player builds on target devices to find actual issues. </p>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="ProfilerAudio.html"></a></span><div class="tip">音频性能分析器 (Audio Profiler)</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ProfilerGI.html"></a></span><div class="tip">Global Illumination Profiler module</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">Copyright © 2020 Unity Technologies. Publication 2019.3</div>
<div class="menu">
<a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
